---
interface Project {
  id: number;
  year: string;
  name: string;
  title: string;
  tech: string[];
  role: string;
  achievements: string[];
}
const projects: Project[] = [
    {
      id: 1,
      year: "2024",
      name: "E-Commerce Mobile App",
      title: "E-Commerce Mobile App",
      tech: ["Kotlin", "Jetpack Compose", "Retrofit", "Room"],
      role: "Lead Android Developer",
      achievements: [
        "Architected and built native Android app from scratch",
        "Implemented offline-first architecture with local caching",
        "Achieved 4.5+ star rating with 50K+ downloads in 6 months",
        "Reduced app launch time by 40% through optimization"
      ]
    },
    {
      id: 2,
      year: "2024",
      name: "Real-time Analytics Dashboard",
      title: "Real-time Analytics Dashboard",
      tech: ["React", "TypeScript", "WebSocket", "D3.js"],
      role: "Frontend Developer",
      achievements: [
        "Built real-time data visualization dashboard for internal tools",
        "Implemented WebSocket connection for live updates",
        "Optimized rendering performance for 10K+ data points",
        "Created reusable chart component library"
      ]
    },
    {
      id: 3,
      year: "2023",
      name: "Fintech Payment SDK",
      title: "Fintech Payment SDK",
      tech: ["Kotlin", "Coroutines", "Security", "REST API"],
      role: "SDK Developer",
      achievements: [
        "Developed secure payment SDK for Android applications",
        "Integrated multiple payment gateway providers",
        "Implemented end-to-end encryption for transactions",
        "Published comprehensive documentation and sample apps"
      ]
    },
    {
      id: 4,
      year: "2023",
      name: "Portfolio Website Builder",
      title: "Portfolio Website Builder",
      tech: ["Next.js", "Tailwind CSS", "MDX", "Vercel"],
      role: "Full Stack Developer",
      achievements: [
        "Created template-based portfolio builder for developers",
        "Implemented markdown-based content management",
        "Built responsive design system with 20+ components",
        "Achieved 95+ Lighthouse performance score"
      ]
    },
    {
      id: 5,
      year: "2022",
      name: "Social Media Android Client",
      title: "Social Media Android Client",
      tech: ["Kotlin", "MVVM", "Paging 3", "Coil"],
      role: "Android Developer",
      achievements: [
        "Built third-party client for social media platform",
        "Implemented infinite scroll with efficient pagination",
        "Created custom image loading and caching system",
        "Maintained 4.8 star rating with active user community"
      ]
    }
  ];

  var selectedProjectId = projects[0].id;
  var selectedProject: Project = projects[0];
  function setSelectedProjectId(e: Event) {
    const id = parseInt((e.target as HTMLElement).dataset.id || "0");
    selectedProjectId = id;
    selectedProject = projects.find((project) => project.id === id) || projects[0];
  }

  const projectsByYear = projects.reduce((acc, project) => {
    if (!acc[project.year]) {
      acc[project.year] = [];
    }
    acc[project.year].push(project);
    return acc;
  }, {} as Record<string, typeof projects>);

  const years = Object.keys(projectsByYear).sort((a, b) => parseInt(b) - parseInt(a));
---

<section class="max-w-6xl mx-auto px-6 md:px-8 py-16 md:py-24 border-t border-border">
  <div class="text-center mb-12 md:mb-16">
    <h2 class="text-2xl md:text-3xl text-foreground mb-2">Projects</h2>
    <p class="text-sm md:text-base text-muted-foreground">제가 작업한 주요 프로젝트들을 소개합니다</p>
  </div>
  
  <div class="grid grid-cols-1 lg:grid-cols-12 gap-8 lg:gap-16">
    {/* Timeline - Horizontal on mobile, vertical on desktop */}
    <div class="lg:col-span-5">
      <div class="relative">
        {/* Vertical line - hidden on mobile */}
        <div class="hidden lg:block absolute left-0 top-2 bottom-2 w-px bg-border" />
        
        <div class="space-y-6 lg:space-y-8">
          {years.map((year) => (
            <div class="space-y-3 lg:space-y-4">
              {/* Year marker */}
              <div class="flex items-center gap-3 lg:gap-4">
                <div class="w-2 h-2 rounded-full bg-primary relative z-10" />
                <p class="text-base lg:text-lg font-medium text-foreground">{year}</p>
              </div>
              
              {/* Projects under this year */}
              <div class="pl-5 lg:pl-6 space-y-2">
                {projectsByYear[year].map((project) => (
                  <button
                    class={`block text-left text-sm lg:text-base transition-colors py-1 ${
                      selectedProjectId === project.id
                        ? 'text-primary font-medium'
                        : 'text-muted-foreground hover:text-foreground'
                    }`}
                  >
                    {project.name}
                  </button>
                ))}
              </div>
            </div>
          ))}
        </div>
      </div>
    </div>

    {/* Detail Panel */}
    <div class="lg:col-span-7">
      <div class="border border-border bg-card p-6 md:p-8 lg:sticky lg:top-8">
        <h3 class="text-xl md:text-2xl mb-6 text-card-foreground">{selectedProject.title}</h3>
        
        {/* Tech stack */}
        <div class="mb-6">
          <p class="text-xs md:text-sm text-muted-foreground mb-3">Tech Stack</p>
          <div class="flex flex-wrap gap-2">
            {selectedProject.tech.map((tech, index) => (
              <span
                class="px-3 py-1.5 bg-secondary text-xs md:text-sm text-secondary-foreground"
              >
                {tech}
              </span>
            ))}
          </div>
        </div>
        
        {/* Role */}
        <div class="mb-6">
          <p class="text-xs md:text-sm text-muted-foreground mb-2">Role</p>
          <p class="text-sm md:text-base text-card-foreground">{selectedProject.role}</p>
        </div>
        
        {/* Key achievements */}
        <div>
          <p class="text-xs md:text-sm text-muted-foreground mb-3">Key Achievements</p>
          <ul class="space-y-2.5">
            {selectedProject.achievements.map((achievement, index) => (
              <li class="text-sm md:text-base text-card-foreground pl-4 relative before:content-['•'] before:absolute before:left-0 before:text-primary">
                {achievement}
              </li>
            ))}
          </ul>
        </div>
      </div>
    </div>
  </div>
</section>